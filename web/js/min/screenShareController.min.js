!function(o){"use strict";var s,a,i,l,n=!1,c=!1,d={insertMode:"append",width:"100%",height:"100%",name:"screen",showControls:!1,style:{nameDisplayMode:"off"},publishAudio:!1,videoSource:"screen"},r={destroyed:function(){i=!1,Utils.sendEvent("screenShareController:destroyed"),c&&Utils.sendEvent("screenShareController:annotationEnded")}},h={shareScreen:function(){var e;n||(i?(l.stopShareScreen(),i=!1):(e=RoomView.createStreamView("desktop",{name:d.name,type:"desktop",controlElems:{}}),n=!0,l.shareScreen(e,d,r,c).then(function(){n=!(i=!0),Utils.sendEvent("screenShareController:changeScreenShareStatus",{isSharing:i}),c&&Utils.sendEvent("screenShareController:annotationStarted")}).catch(function(e){n=!1,e.code===OTHelper.screenShareErrorCodes.accessDenied?RoomView.deleteStreamView("desktop"):Utils.sendEvent("screenShareController:shareScreenError",{code:e.code,message:e.message})})))}},S={installExtension:function(){var e=window.open("https://chrome.google.com/webstore/detail/"+a,"_blank"),n=!e||"object"!=typeof e;Utils.sendEvent("screenShareController:extInstallationResult",{error:n,message:n?"It seems you have a Pop-Up blocker enabled. Please disabled it and try again.":null}),n&&s.error("Error opening Chrome Webstore")}};var e={init:function(e,n,r,t){return LazyLoader.dependencyLoad(["/js/screenShareView.js"]).then(function(){c=t,l=r,s=new Utils.MultiLevelLogger("screenShareController.js",Utils.MultiLevelLogger.DEFAULT_LEVELS.all),Utils.addEventsHandlers("roomView:",h,o),Utils.addEventsHandlers("screenShareView:",S,o),i=!1,d.name=(e||"Unknown")+"'s screen",(a=n)&&"undefined"!==n&&OTHelper.registerScreenShareExtension({chrome:n},1),ScreenShareView.init(e)})},get chromeExtId(){return a}};o.ScreenShareController=e}(this);